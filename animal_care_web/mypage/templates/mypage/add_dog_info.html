{% extends 'base.html' %}

{% block content %}
<main>
    <h1>강아지 정보 입력</h1>
    
    <!-- action 속성을 dog_info_submit URL로 설정 -->
    <form action="{% url 'mypage:dog_info_submit' %}" method="post" enctype="multipart/form-data">
        {% csrf_token %}
        {{ form.as_p }}
        
        <!-- 반려동물 정보 추가하기 버튼 아래에 추가 -->
        <input type="file" id="pet-image-input" accept="image/*" style="display: none;" name="pet_image">
        <label for="pet-image-input" id="pet-image-label" class="image-label">반려동물 이미지 선택</label>
        <img id="pet-image-preview" class="pet-image-preview" src="#" alt="반려동물 이미지 미리보기" style="display: none;">
    
        <button type="submit">정보 제출하기</button>
    </form>
</main>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // 반려동물 이미지 input 변경 이벤트 처리
        const petImageInput = document.getElementById('pet-image-input');
        const petImageLabel = document.getElementById('pet-image-label');
        const petImagePreview = document.getElementById('pet-image-preview');

        petImageInput.addEventListener('change', function() {
            const file = petImageInput.files[0];
            if (file) {
                const reader = new FileReader();

                reader.addEventListener('load', function() {
                    petImagePreview.src = reader.result;
                    petImagePreview.style.display = 'block';
                });

                reader.readAsDataURL(file);
            }
        });

        // 반려동물 이미지 선택 레이블 위치 조정
        const submitButton = document.querySelector('button[type="submit"]');
        submitButton.insertAdjacentElement('beforebegin', petImageLabel);
    });
</script>

<style>
    /* 이미지 미리보기 스타일 */
    .pet-image-preview {
        max-width: 100%;
        margin-top: 20px;
        display: none; /* 초기에는 숨김 */
    }

    /* 이미지 라벨 위치 조정 */
    .image-label {
        display: inline-block;
        margin-bottom: 10px;
    }
</style>
{% endblock %}
